/**
 * @copyright Zack Qattan 2024
 * @license MIT
 */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).NativeWebKit={})}(this,(function(e){"use strict";const t=!1;function s(){}const i=console.log.bind(console),n=console.warn.bind(console),a=console.error.bind(console),o=console.assert.bind(console);class r{static#e={};constructor(e){if(r.#e[e])throw new Error(`"${e}" console already exists`);r.#e[e]=this}#t={log:t,warn:t,error:t};setLevelFlags(e){Object.assign(this.#t,e)}static setLevelFlagsForType(e,t){if(!this.#e[e])throw new Error(`no console found with type "${e}"`);this.#e[e].setLevelFlags(t)}static setAllLevelFlags(e){for(const t in this.#e)this.#e[t].setLevelFlags(e)}static create(e,t){return this.#e[e]||new r(e)}get log(){return this.#t.log?i:s}get warn(){return this.#t.warn?n:s}get error(){return this.#t.error?a:s}get assert(){return this.#t.assert?o:s}assertWithError(e,t){if(!e)throw new Error(t)}}function c(e,t){return r.create(e,t)}const l=c("EventDispatcher",{log:!1});class h{constructor(e){l.assertWithError(Array.isArray(e),"eventTypes must be an array"),this.#s=e}#s;#i(e){return!this.#s||this.#s.includes(e)}#n(e){l.assertWithError(this.#i(e),`invalid event type "${e}"`)}#a;addEventListener(e,t,s){if(l.log(`adding "${e}" eventListener`,t),this.#n(e),this.#a||(this.#a={}),s?.once){const s=t;t=function t(i){s.apply(this,arguments),this.removeEventListener(e,t)}}const i=this.#a;i[e]||(i[e]=[]),i[e].includes(t)||i[e].push(t)}hasEventListener(e,t){return l.log(`has "${e}" eventListener?`,t),this.#n(e),this.#a?.[e]?.includes(t)}removeEventListener(e,t){if(l.log(`removing "${e}" eventListener`,t),this.#n(e),this.hasEventListener(e,t)){const s=this.#a[e].indexOf(t);return this.#a[e].splice(s,1),!0}return!1}dispatchEvent(e){if(this.#n(e.type),this.#a?.[e.type]){e.target=this;const t=this.#a[e.type].slice(0);for(let s=0,i=t.length;s<i;s++)t[s].call(this,e)}}get _prefix(){return""}formatMessage(e){const t={...e};return t.type=`${this._prefix}-${e.type}`,t}}const p=c("platformUtils",{log:!1}),{userAgent:d}=navigator,g=/Safari/i.test(d)&&!/Chrome/i.test(d),u=/NativeWebKit/i.test(d);var v=Boolean(window.isNativeWebKitSafariExtensionInstalled);const f=async()=>!!(v=v||Boolean(window.isNativeWebKitSafariExtensionInstalled))||(p.log("checking if Safari Extension is installed..."),new Promise((e=>{const t=()=>{p.log("Safari Extension is installed"),v=!0,e(!0)};window.addEventListener("nativewebkit-extension-is-installed",t,{once:!0}),window.dispatchEvent(new Event("is-nativewebkit-extension-installed")),window.setTimeout((()=>{v||(p.log("Safari Extension is not installed"),window.removeEventListener("nativewebkit-extension-is-installed",t),e(!1))}),1)})));const m=async()=>!!(u||v)||await f(),y=/iPad|iPhone|iPod/.test(d),k=/Macintosh/.test(d),b=c("messaging",{log:!1}),w=new Set;const A={};function T(e,t){b.log(`adding callback with prefix "${t}"`,e),A[t]||(A[t]=[]),A[t].push(e)}function E(e){Array.isArray(e)||(e=[e]),e=e.flatMap((e=>"messages"==e.type?e.messages:e)),b.log("nativewebkit-receive messages",e),e.forEach((e=>{const[t,s]=e.type.split("-");b.log(`received "${t}" message of type "${s}"`,e),e.type=s,A[t]&&0!=A[t].length?A[t].forEach((t=>{b.log("triggering callback",t,"for message",e),t(e)})):b.warn("no callbacks listening for prefix",t)}))}window.__NATIVEWEBKIT_MESSAGING_FLAG__||(window.__NATIVEWEBKIT_MESSAGING_FLAG__=!0,b.log('adding "nativewebkit-receive" window listener'),window.addEventListener("nativewebkit-receive",(e=>{E(e.detail)})),window.addEventListener("load",(()=>{b.log("triggering window.load events...");const e=A["window.load"]?.map((e=>e())).flat().filter(Boolean);e.length>0&&M(e)})),window.addEventListener("unload",(()=>{b.log("triggering window.unload events...");const e=A["window.unload"]?.map((e=>e())).flat().filter(Boolean);e.length>0&&M(e)})));var S,O,L=[];async function M(e,t=!0){if(await m()){if(b.log("requesting to send message",e,"send immediately?",t),!e&&0==L.length)return void b.warn("no messages received, and no pending messages");if(e&&(0==L.length&&(S=new Promise((e=>{O=e}))),L.push(e),L=L.flat()),0==L.length)return void b.log("no messages to send");if(!t)return S;if(b.log("sending messages to app...",L),u){const e=await webkit.messageHandlers.nativewebkit_reply.postMessage(L);b.log("app response",e),e&&E(e),O(!0)}else{const e=function(){for(var e=0;w.has(e);)e++;return w.add(e),e}();window.dispatchEvent(new CustomEvent("nativewebkit-send",{detail:{message:L,id:e}})),window.addEventListener(`nativewebkit-receive-${e}`,(t=>{const s=t.detail;b.log(`did receive message for nativewebkit-receive-${e}?`,s),s||b.error(`didn't receive message for nativewebkit-receive-${e}`),O(s),w.delete(e)}),{once:!0})}return L.length=0,S}b.warn("NativeWebKit.js is not enabled - run in the NativeWebKit app or enable the NativeWebKit Safari Web Extension")}const C=c("mathUtils",{log:!1});function I(e,t){return 0===t?e:I(t,e%t)}function W(e){if(C.log("finding greatestCommonFactor of numbers",e),0==(e=e.filter((e=>e>0))).length)return null;const t=e.reduce(((e,t)=>I(e,t)));return C.log("greatestCommonFactor",t),0==t?null:t}const U=c("AppMessagePoll",{log:!1});class R{#o=!1;async#r(){if(!await m())return!1;if(u)return this.#o;return await f()}static#c=[];static#l(e){return this.#c.includes(e)?(U.log("poll already included"),this.#c.indexOf(e)):this.#c.push(e)}static#h(e){return this.#c.includes(e)?(e.stop(),this.#c.splice(e,e.#p),this.#d(),!0):(U.log("poll wasn't included"),!1)}get#p(){return R.#c.indexOf(this)}#g;#u="";#v;#f=0;get interval(){return this.#v}set interval(e){U.assertWithError(e>0,`invalid interval ${e}ms`),e!=this.#v?(this.#v=e,this.#m&&R.#d()):U.warn("assigning same interval")}constructor(e,t,s,i=!1){if("function"==typeof e){const t=e;this.#g=t}else{const t=e;this.#g=()=>t}this.#u=t,this.#v=s,this.#o=i,R.#l(this)}static#y=null;static get#k(){return null!=this.#y}static#b=null;static get#w(){return this.#c.filter((e=>e.#A))}static get#T(){return this.#w.map((e=>e.#v))}static#E(){var e=W(this.#T);if(U.log(`new interval ${e}`),this.#b!=e)return U.log(`interval updated from ${this.#b} to ${e}`),this.#b=e,!0}static async#S(){const e=Date.now(),t=this.#w.filter((t=>e-t.#f>=t.#v)),s=t.map((e=>{const t=Object.assign({},e.#g());return t.type=`${e.#u}-${t.type}`,t}));if(U.log("messages",s),s.length>0){const e=await M(s);U.log("didReceiveMessage?",e),e||U.error("app didn't receive message")}else U.log("no messages to send");t.forEach((t=>t.#f=e))}static#O(){this.#k?U.log("tried to start AppMessagePoll when it's already running"):null!=this.#b?(U.log(`starting interval at ${this.#b}`),this.#y=window.setInterval(this.#S.bind(this),this.#b)):U.log("null interval")}static#L(){this.#k?(window.clearInterval(this.#y),this.#y=null):U.log("tried to stop AppMessagePoll when it already isn't running")}static#d(e=!1){if(!this.#k&&!e)return;const t=this.#E();this.#k||t?(U.log("restarting..."),this.#L(),this.#O()):U.log("no need to restart")}#A=!1;get#m(){return R.#k&&this.#A}async start(){await this.#r()&&(this.#m?U.log("poll is already running"):(this.#A=!0,R.#d(!0)))}stop(){this.#m&&(this.#A=!1,R.#d())}destroy(){U.log("destroying poll",this),R.#h(this)}}const D=c("HeadphoneMotionManager",{log:!1});class ${static#M=["isAvailable","isActive","motionData","sensorLocation"];get eventTypes(){return $.#M}#C=new h(this.eventTypes);addEventListener(e,t,s){return this.#C.addEventListener(e,t,s)}removeEventListener(e,t){return this.#C.removeEventListener(e,t)}hasEventListener(e,t){return this.#C.hasEventListener(e,t)}dispatchEvent(e){return this.#C.dispatchEvent(e)}static#I=new $;static get shared(){return this.#I}#u="hm";#W(e){return e.map((e=>Object.assign({},e,{type:`${this.#u}-${e.type}`})))}constructor(){D.assertWithError(!this.shared,"HeadphoneMotionManager is a singleton - use HeadphoneMotionManager.shared"),T(this.#U.bind(this),"window.load"),T(this.#R.bind(this),this.#u),T(this.#D.bind(this),"window.unload")}#U(){const e=[];return this.#$&&e.push({type:"isAvailable"}),this.#W(e)}#D(){const e=[];return this.#F&&this.#x&&e.push({type:"stopUpdates"}),this.#W(e)}async sendMessageToApp(e){return e.type=`${this.#u}-${e.type}`,M(e)}#$=!1;get checkAvailabilityOnLoad(){return this.#$}set checkAvailabilityOnLoad(e){D.assertWithError("boolean"==typeof e,"invalid newValue for checkAvailabilityOnLoad",e),this.#$=e}#x=!0;get stopUpdatesOnUnload(){return this.#x}set stopUpdatesOnUnload(e){D.assertWithError("boolean"==typeof e,"invalid newValue for stopUpdatesOnUnload",e),this.#x=e}#R(e){D.log(`received background message of type ${e.type}`,e);const{type:t}=e;switch(t){case"isAvailable":this.#P(e.isAvailable);break;case"isActive":this.#V(e.isActive);break;case"getData":this.#B(e.motionData);break;default:throw Error(`uncaught message type ${t}`)}}#_=null;get isAvailable(){return Boolean(this.#_)}#P(e){this.#_!=e&&(this.#_=e,D.log(`updated isAvailable to ${e}`),this.dispatchEvent({type:"isAvailable",message:{isAvailable:this.isAvailable}}),this.#_&&this.#j())}async#K(){return D.log("checking isAvailable..."),this.sendMessageToApp({type:"isAvailable"})}#F=null;get isActive(){return Boolean(this.#F)}#V(e){this.#F!=e&&(this.#F=e,D.log(`updated isActive to ${this.isActive}`),this.dispatchEvent({type:"isActive",message:{isActive:this.isActive}}),this.#N.stop(),this.#F?(D.log("starting motion data poll"),this.#G.start()):(D.log("stopping motion data poll"),this.#G.stop()))}async#j(){return D.log("checking isActive"),this.sendMessageToApp({type:"isActive"})}#N=new R({type:"isActive"},this.#u,50,!0);async startUpdates(){if(this.isAvailable){if(!this.isActive)return D.log("starting motion updates"),this.#N.start(),this.sendMessageToApp({type:"startUpdates"});D.warn("already active")}else D.warn("not available")}async stopUpdates(){if(this.isAvailable){if(this.isActive)return D.log("stopping motion updates"),this.#N.start(),this.sendMessageToApp({type:"stopUpdates"});D.warn("already inactive")}else D.warn("not available")}async toggleMotionUpdates(){if(this.isAvailable)return this.isActive?this.stopUpdates():this.startUpdates();D.log("not available")}#H;get motionData(){return this.#H}get#q(){return this.motionData?.timestamp||0}#z=null;get sensorLocation(){return this.#z}#J(e){this.#z!=e&&(this.#z=e,D.log(`updated sensor location to ${e}`),this.dispatchEvent({type:"sensorLocation",message:{sensorLocation:this.sensorLocation}}))}#B(e){this.#H=e,D.log("received headphone motion data",this.motionData),this.dispatchEvent({type:"motionData",message:{motionData:this.motionData}}),this.#J(e.sensorLocation)}#Q(){return{type:"getData",timestamp:this.#q}}#G=new R(this.#Q.bind(this),this.#u,20)}var F=$.shared;function x(e,t){if("object"!=typeof e||"object"!=typeof t)return!1;const s=Object.keys(e),i=Object.keys(t);if(s.length!=i.length)return!1;return s.every((s=>s in t&&e[s]==t[s]))}const P=c("ARSession",{log:!1});class V{static#M=["worldTrackingSupport","faceTrackingSupport","bodyTrackingSupport","isRunning","frame","camera","faceAnchors","debugOptions","cameraMode","configuration","showCamera","lightEstimate","messageConfiguration","planeAnchors","bodyAnchors"];get eventTypes(){return V.#M}#C=new h(this.eventTypes);addEventListener(e,t,s){return this.#C.addEventListener(...arguments)}removeEventListener(e,t){return this.#C.removeEventListener(...arguments)}hasEventListener(e,t){return this.#C.hasEventListener(...arguments)}dispatchEvent(e){return this.#C.dispatchEvent(...arguments)}static#I=new V;static get shared(){return this.#I}#u="ars";#W(e){return e.map((e=>Object.assign({},e,{type:`${this.#u}-${e.type}`})))}constructor(){P.assertWithError(!this.shared,"ARSessionManager is a singleton - use ARSessionManager.shared"),T(this.#U.bind(this),"window.load"),T(this.#R.bind(this),this.#u),T(this.#D.bind(this),"window.unload")}get isSupported(){return y&&u}#X(){if(!this.isSupported)throw k?Error("AR Session is not supported on Mac"):Error("AR Session not supported in iOS Safari")}#Y(){P.assertWithError(this.isRunning,"ARSession is not running")}async sendMessageToApp(e){return e.type=`${this.#u}-${e.type}`,M(e)}#U(){if(!this.isSupported)return;const e=[];return this.checkFaceTrackingSupportOnLoad&&e.push({type:"faceTrackingSupport"}),this.checkWorldTrackingSupportOnLoad&&e.push({type:"worldTrackingSupport"}),this.checkBodyTrackingSupportOnLoad&&e.push({type:"bodyTrackingSupport"}),this.checkIsRunningOnLoad&&e.push({type:"isRunning"}),this.checkDebugOptionsOnLoad&&e.push({type:"debugOptions"}),this.checkCameraModeOnLoad&&e.push({type:"cameraMode"}),this.checkShowCameraOnLoad&&e.push({type:"showCamera"}),this.#W(e)}#D(){if(!this.isSupported)return;const e=[];return this.pauseOnUnload&&this.isRunning&&e.push({type:"pause"}),this.#W(e)}#Z={isSupported:null,supportsUserFaceTracking:null};get worldTrackingSupport(){return this.#Z}#ee(e){x(this.#Z,e)||(this.#Z=e,P.log("updated worldTrackingSupport",e),this.dispatchEvent({type:"worldTrackingSupport",message:{worldTrackingSupport:this.worldTrackingSupport}}))}#te=!1;get checkWorldTrackingSupportOnLoad(){return this.#te}set checkWorldTrackingSupportOnLoad(e){P.assertWithError("boolean"==typeof e,"invalid newValue for checkWorldTrackingSupportOnLoad",e),this.#te=e}#se={isSupported:null};get bodyTrackingSupport(){return this.#se}#ie(e){x(this.#se,e)||(this.#se=e,P.log("updated bodyTrackingSupport",e),this.dispatchEvent({type:"bodyTrackingSupport",message:{bodyTrackingSupport:this.bodyTrackingSupport}}))}#ne=!1;get checkBodyTrackingSupportOnLoad(){return this.#ne}set checkBodyTrackingSupportOnLoad(e){P.assertWithError("boolean"==typeof e,"invalid newValue for checkBodyTrackingSupportOnLoad",e),this.#ne=e}#ae={isSupported:null,supportsWorldTracking:null};get faceTrackingSupport(){return this.#ae}#oe(e){x(this.#ae,e)||(this.#ae=e,P.log("updated faceTrackingSupport",e),this.dispatchEvent({type:"faceTrackingSupport",message:{faceTrackingSupport:this.faceTrackingSupport}}))}#re=!1;get checkFaceTrackingSupportOnLoad(){return this.#re}set checkFaceTrackingSupportOnLoad(e){P.assertWithError("boolean"==typeof e,"invalid newValue for checkFaceTrackingSupportOnLoad",e),this.#re=e}#m=!1;get isRunning(){return this.#m}#ce(e){this.#m!=e&&(this.#m=e,P.log(`updated isRunning to ${e}`),this.dispatchEvent({type:"isRunning",message:{isRunning:this.isRunning}}),this.isRunning&&this.#le())}#he=!1;get checkIsRunningOnLoad(){return this.#he}set checkIsRunningOnLoad(e){P.assertWithError("boolean"==typeof e,"invalid newValue for checkIsRunningOnLoad",e),this.#he=e}#pe=!0;get pauseOnUnload(){return this.#pe}set pauseOnUnload(e){P.assertWithError("boolean"==typeof e,"invalid newValue for pauseOnUnload",e),this.#pe=e}#de(e){switch(P.log("assertConfigurationIsValid",e),P.assertWithError(e,"configuration required to run ARSession"),P.assertWithError(e.type,'"type" property required in configuration"'),P.assertWithError(this.allConfigurationTypes.includes(e.type),`invalid configuration type "${e.type}"`),e.type){case"worldTracking":const t=Object.keys(e).find((e=>"type"!==e&&!this.#ge.includes(e)));P.assertWithError(!t,`invalid worldTracking configuration key "${t}"`);const s=e;P.assertWithError(null!=this.worldTrackingSupport.isSupported,"check for world tracking support before running an AR session"),P.assertWithError(this.worldTrackingSupport.isSupported,"your device doesn't support world tracking"),P.assertWithError(!s.userFaceTrackingEnabled||this.worldTrackingSupport.supportsUserFaceTracking,"your device doesn't support user face tracking with world tracking");break;case"faceTracking":const i=Object.keys(e).find((e=>"type"!==e&&!this.#ue.includes(e)));P.assertWithError(!i,`invalid faceTracking configuration key "${i}"`);const n=e;P.assertWithError(null!=this.#ae.isSupported,"check for face tracking support before running an AR session"),P.assertWithError(this.faceTrackingSupport.isSupported,"your device doesn't support face tracking"),P.assertWithError(!n.isWorldTrackingEnabled||this.faceTrackingSupport.supportsWorldTracking,"your device doesn't support user world tracking with face tracking");break;case"bodyTracking":break;default:throw Error(`uncaught configuration type "${e.type}"`)}}async run(e){return this.#X(),this.#de(e),P.log("running with configuraton",e),this.sendMessageToApp({type:"run",configuration:e})}async pause(){return P.log("pause..."),this.sendMessageToApp({type:"pause"})}#ve=["worldTracking","faceTracking","bodyTracking"];get allConfigurationTypes(){return this.#ve}#ge=["userFaceTrackingEnabled","planeDetection","frameSemantics"];#ue=["isWorldTrackingEnabled","maximumNumberOfTrackedFaces"];#fe=null;get configuration(){return this.#fe}async#le(){return this.#X(),this.#Y(),P.log("checking configuration..."),this.sendMessageToApp({type:"configuration"})}#me(e){this.#fe=e,P.log("updated configuration",this.configuration),this.dispatchEvent({type:"configuration",message:{configuration:this.configuration}})}#ye=null;get frame(){return this.#ye}#ke(e){this.#ye=e,P.log("received frame",this.frame),this.dispatchEvent({type:"frame",message:{frame:this.frame}}),this.#be(e.camera),e.lightEstimate&&this.#we(e.lightEstimate),this.#Ae(e.faceAnchors||[]),this.#Te(e.planeAnchors||[]),this.#Ee(e.bodyAnchors||[])}#Se=null;get camera(){return this.#Se}#be(e){this.#Se=e,P.log("received camera",this.camera),this.dispatchEvent({type:"camera",message:{camera:this.camera}})}#Oe=null;get lightEstimate(){return this.#Oe}#we(e){this.#Oe=e,P.log("received lightEstimate",this.lightEstimate),this.dispatchEvent({type:"lightEstimate",message:{lightEstimate:this.lightEstimate}})}#Le=null;get faceAnchors(){return this.#Le}#Ae(e){this.#Le=e,P.log("received faceAnchors",this.faceAnchors),this.dispatchEvent({type:"faceAnchors",message:{faceAnchors:this.faceAnchors}})}#Me=null;get planeAnchors(){return this.#Me}#Te(e){this.#Me=e,P.log("received planeAnchors",this.planeAnchors),this.dispatchEvent({type:"planeAnchors",message:{planeAnchors:this.planeAnchors}})}#Ce=null;get bodyAnchors(){return this.#Ce}#Ee(e){this.#Ce=e,P.log("received bodyAnchors",this.bodyAnchors),this.dispatchEvent({type:"bodyAnchors",message:{bodyAnchors:this.bodyAnchors}})}#Ie=["none","showAnchorGeometry","showAnchorOrigins","showFeaturePoints","showPhysics","showSceneUnderstanding","showStatistics","showWorldOrigin"];get allDebugOptions(){return this.#Ie}#We=null;get debugOptions(){return this.#We}#Ue(e){this.#We=e,P.log("received debugOptions",this.debugOptions),this.dispatchEvent({type:"debugOptions",message:{debugOptions:this.debugOptions}})}async setDebugOptions(e){this.#X(),P.assertWithError("object"==typeof e,"debugOptions must be an object",e);const t=Object.keys(e).find((e=>!this.#Ie.includes(e)));return P.assertWithError(!t,`invalid debugOptions key ${t}`),P.log("setting debugOptions...",e),this.sendMessageToApp({type:"debugOptions",debugOptions:e})}#Re=!1;get checkDebugOptionsOnLoad(){return this.#Re}set checkDebugOptionsOnLoad(e){P.assertWithError("boolean"==typeof e,"invalid newValue for checkDebugOptionsOnLoad",e),this.#Re=e}#De=["ar","nonAR"];get allCameraModes(){return this.#De}#$e=null;get cameraMode(){return this.#$e}async setCameraMode(e){this.#X();const t=this.#De.includes(e);if(P.assertWithError(t,`invalid cameraMode "${e}"`),e!=this.#$e)return P.log("setting cameraMode...",e),this.sendMessageToApp({type:"cameraMode",cameraMode:e});P.log(`cameraMode is already set to "${this.#$e}"`)}#Fe=!1;get checkCameraModeOnLoad(){return this.#Fe}set checkCameraModeOnLoad(e){P.assertWithError("boolean"==typeof e,"invalid newValue for checkCameraModeOnLoad",e),this.#Fe=e}#xe(e){this.#$e!=e&&(this.#$e=e,P.log(`updated cameraMode to ${this.cameraMode}`),this.dispatchEvent({type:"cameraMode",message:{cameraMode:this.cameraMode}}))}#Pe=null;get showCamera(){return this.#Pe}#Ve(e){this.#Pe!=e&&(this.#Pe=e,P.log(`updated showCamera to ${this.showCamera}`),this.dispatchEvent({type:"showCamera",message:{showCamera:this.showCamera}}))}#Be=!1;get checkShowCameraOnLoad(){return this.#Be}set checkShowCameraOnLoad(e){P.assertWithError("boolean"==typeof e,"invalid newValue for checkShowCameraOnLoad",e),this.#Be=e}async setShowCamera(e){if(this.#X(),e!=this.#Pe)return P.log("setting showCamera...",e),this.sendMessageToApp({type:"showCamera",showCamera:e});P.log(`showCamera is already set to "${this.#Pe}"`)}#_e={faceAnchorBlendshapes:!1,faceAnchorGeometry:!1,faceAnchorEyes:!1};get messageConfiguration(){return this.#_e}async setMessageConfiguration(e){return this.#X(),P.log("setting messageConfiguration...",e),this.sendMessageToApp({type:"messageConfiguration",messageConfiguration:e})}#je(e){this.#_e=e,P.log("updated messageConfiguration",this.messageConfiguration),this.dispatchEvent({type:"messageConfiguration",message:{messageConfiguration:this.messageConfiguration}})}#R(e){P.log(`received background message of type ${e.type}`,e);const{type:t}=e;switch(t){case"faceTrackingSupport":P.log("received faceTrackingSupport message",e),this.#oe(e.faceTrackingSupport);break;case"worldTrackingSupport":P.log("received worldTrackingSupport message",e),this.#ee(e.worldTrackingSupport);break;case"bodyTrackingSupport":P.log("received bodyTrackingSupport message",e),this.#ie(e.bodyTrackingSupport);break;case"isRunning":P.log("received isRunning message",e),this.#ce(e.isRunning);break;case"configuration":P.log("received configuration message",e),this.#me(e.configuration);break;case"debugOptions":P.log("received debugOptions message",e),this.#Ue(e.debugOptions);break;case"cameraMode":P.log("received cameraMode message",e),this.#xe(e.cameraMode);break;case"frame":P.log("received frame message",e),this.#ke(e.frame);break;case"showCamera":P.log("received showCamera message",e),this.#Ve(e.showCamera);break;case"messageConfiguration":P.log("received messageConfiguration message",e),this.#je(e.messageConfiguration);break;default:throw Error(`uncaught message type ${t}`)}}}var B=V.shared;var _=Object.freeze({__proto__:null,areObjectsEqual:x,checkIfNativeWebKitEnabled:m,checkIfSafariExtensionIsInstalled:f,colorTemperatureToRGB:function(e){var t,s,i,n=e/100;return n<=66?(t=255,s=n,s=99.4708025861*Math.log(s)-161.1195681661,n<=19?i=0:(i=n-10,i=138.5177312231*Math.log(i)-305.0447927307)):(t=n-60,t=329.698727446*Math.pow(t,-.1332047592),s=n-60,s=288.1221695283*Math.pow(s,-.0755148492),i=255),[t,s,i].map((e=>function(e,t,s){return e<t?t:e>s?s:e}(e/255,0,1)))},isInApp:u,isInSafari:g,isMac:k,is_iOS:y,openInApp:()=>{if(g){const e=document.createElement("a"),t=`nativewebkit://${location.href}`;p.log("attempting to open current link in App...",location.href,t),e.href=t,e.click()}else p.warn("unable to open link in app - not in safari")},setAllConsoleLevelFlags:function(e){r.setAllLevelFlags(e)},setConsoleLevelFlagsForType:function(e,t){r.setLevelFlagsForType(e,t)}});e.ARSessionManager=B,e.HeadphoneMotionManager=F,e.utils=_}));
